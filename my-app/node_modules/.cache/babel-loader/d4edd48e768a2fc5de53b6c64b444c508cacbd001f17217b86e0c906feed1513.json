{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from\"react\";import{useUser,useSupabaseClient}from\"@supabase/auth-helpers-react\";import{nanoid}from\"nanoid\";import{jsx as _jsx}from\"react/jsx-runtime\";const SupabaseContext=/*#__PURE__*/createContext();export const SupabaseProvider=_ref=>{let{children}=_ref;const CDNURL=\"https://przngajjwwvpyqdplgfs.supabase.co/storage/v1/object/public/images/\";const[images,setImages]=useState([]);const user=useUser();const supabase=useSupabaseClient();async function getImages(){const{data,error}=await supabase.storage.from(\"images\").list((user===null||user===void 0?void 0:user.id)+\"/\",{limit:100,offset:0,sortBy:{column:\"name\",order:\"asc\"}});if(data!==null){console.log(\"data\",data);setImages(data);}else{console.log(\"error\",error);}}useEffect(()=>{if(user){getImages();}},[user]);async function signIn(){const{data,error}=await supabase.auth.signInWithOtp({email});if(error)console.log(\"error\",error);}async function signOut(){const{error}=await supabase.auth.signOut();if(error)console.log(\"error\",error);}async function uploadImage(e){let file=e.target.files[0];const{data,error}=await supabase.storage.from(\"images\").upload(user.id+\"/\"+nanoid(),file);if(data){getImages();}else{console.log(\"error\",error);}}return/*#__PURE__*/_jsx(SupabaseContext.Provider,{value:{signIn,signOut,uploadImage,getImages,images,setImages,CDNURL,user,supabase},children:children});};export const useSupabase=()=>{const context=useContext(SupabaseContext);if(!context){throw new Error(\"useCart must be used within a CartProvider\");}return context;};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","useUser","useSupabaseClient","nanoid","jsx","_jsx","SupabaseContext","SupabaseProvider","_ref","children","CDNURL","images","setImages","user","supabase","getImages","data","error","storage","from","list","id","limit","offset","sortBy","column","order","console","log","signIn","auth","signInWithOtp","email","signOut","uploadImage","e","file","target","files","upload","Provider","value","useSupabase","context","Error"],"sources":["/workspaces/FoodRecipe/my-app/src/context/SupabaseContext.jsx"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from \"react\";\nimport { useUser, useSupabaseClient } from \"@supabase/auth-helpers-react\";\nimport { nanoid } from \"nanoid\";\n\nconst SupabaseContext = createContext();\n\nexport const SupabaseProvider = ({ children }) => {\n  const CDNURL =\n    \"https://przngajjwwvpyqdplgfs.supabase.co/storage/v1/object/public/images/\";\n  const [images, setImages] = useState([]);\n  const user = useUser();\n  const supabase = useSupabaseClient();\n\n  async function getImages() {\n    const { data, error } = await supabase.storage\n      .from(\"images\")\n      .list(user?.id + \"/\", {\n        limit: 100,\n        offset: 0,\n        sortBy: { column: \"name\", order: \"asc\" },\n      });\n\n    if (data !== null) {\n      console.log(\"data\", data);\n      setImages(data);\n    } else {\n      console.log(\"error\", error);\n    }\n  }\n  useEffect(() => {\n    if (user) {\n      getImages();\n    }\n  }, [user]);\n  async function signIn() {\n    const { data, error } = await supabase.auth.signInWithOtp({ email });\n    if (error) console.log(\"error\", error);\n  }\n  async function signOut() {\n    const { error } = await supabase.auth.signOut();\n    if (error) console.log(\"error\", error);\n  }\n  async function uploadImage(e) {\n    let file = e.target.files[0];\n\n    const { data, error } = await supabase.storage\n      .from(\"images\")\n      .upload(user.id + \"/\" + nanoid(), file);\n\n    if (data) {\n      getImages();\n    } else {\n      console.log(\"error\", error);\n    }\n  }\n  return (\n    <SupabaseContext.Provider\n      value={{\n        signIn,\n        signOut,\n        uploadImage,\n        getImages,\n        images,\n        setImages,\n        CDNURL,\n        user,\n        supabase\n      }}\n    >\n      {children}\n    </SupabaseContext.Provider>\n  );\n};\n\nexport const useSupabase = () => {\n  const context = useContext(SupabaseContext);\n  if (!context) {\n    throw new Error(\"useCart must be used within a CartProvider\");\n  }\n  return context;\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}